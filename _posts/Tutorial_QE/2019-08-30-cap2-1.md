---
title: "Tutorial Quantum ESPRESSO: Obtendo a estrutura de equilíbrio"
date: 2019-08-30
tags: [QE, Tutorial]
classes: wide
header:
  teaser: images/posts/tutorial_qe/logo_header.jpg
excerpt: "Obtendo a estrutura de equilíbrios"
mathjax: "true"
---

Geralmente quando desejamos fazer qualquer tipo de cálculo com determinada estrutura, precisamos que ela esteja em seu estado de equilíbrio, *i. e.* as forças entre os átomos são as menores possíveis e a energia total é um mínimo na superfície de potencial. Mesmo quando desejamos fazer cálculos com um material que já possui sua estrutura determinada por difração de raios-X ou por RMN, precisamos otimizar a estrutura para o nível em que estamos fazendo o cálculo. Existem algumas maneiras de fazer esse processo de otimização, que em geral se resume a determinar a **superfície de energia potencial** dos íons e procurar nessa superfície por mínimos globais. Para casos simples, veremos que podemos fazer esse processo manualmente. Já para casos mais complexos recorreremos a algoritmos poderosos para procurar esse mínimo de maneira automatizada.

# Sistemas moleculares (0D)

O nosso objetivo principal é determinar a estrutura que corresponda a um mínimo na superfície de energia potencial. Para explorar esse conceito vamos olhar para um caso simples, que apesar de não ser periódico é bastante instrutivo: A molécula de $$N_2$$. Experimentalmente observa-se que o comprimento da ligação dessa molécula é de 1.0975 Å [1]. Dessa forma, podemos construir a curva de energia potencial fazendo um gráfico da energia em função da distância de ligação entre os átomos $$d_{N-N}$$.

Para isso, crie um *script* de submissão como o abaixo:

```bash
D_NN = '0.878'
PREFIX="n2_$D_NN"
PSEUDO_DIR="/home/pseudo"
CALC="scf"
CMD_PW="mpirun -np 4 /home/interlab/qe/bin/pw.x -nk 1"

#Make SCF calculation
cat>$PREFIX.$CALC.in<<EOF
 &control
	calculation = '$CALC' ,
	restart_mode = 'from_scratch' ,
	wf_collect = .false. ,
	outdir = '.' ,
	pseudo_dir = '$PSEUDO_DIR' ,
	prefix = '$PREFIX' ,
 /
 &system
	ibrav = 1 	celldm(1) = 20
	nat =  2 ,	ntyp = 1 ,
	ecutwfc = 80.0 ,	ecutrho = 600.0 ,
 /
 &electrons
	conv_thr =  1.0D-10 ,	electron_maxstep = 5000 ,
 /
ATOMIC_SPECIES
	N   14.0107  N.pbe-van_ak.UPF
ATOMIC_POSITIONS (angstrom)
	N        0.000000000   0.000000000   0.000000000
	N        $D_NN         0.000000000   0.000000000
K_POINTS automatic
	1 1 1   0 0 0
EOF
$CMD_PW < $PREFIX.$CALC.in > $PREFIX.$CALC.out
```

Execute o cálculo editando a variável D_NN, modificando posição do segundo átomo de nitrogênio seguindo os valores: 0.8780 0.9011 0.9242 0.9473 0.9704 0.9935 1.0166 1.0397 1.0628 1.08596 1.1090 1.1321 1.1552 1.1783 1.2014 1.2245 1.2476 1.2707 1.2938 1.3170.

Como o primeiro átomo de nitrogênio está na origem, a posição do segundo átomo nos dará exatamente o tamanho da ligação. Perceba que estamos fazendo o cálculo para uma molécula isolada, entretanto o QE lida com sistemas periódicos. Para que possamos fazer o cálculo sem menores problemas, vamos considerar uma célula unitária bem grande e um grande espaço vazio entre as moléculas, chamado de *slab*, de forma que as moléculas de nitrogênio dentro da caixa não consigam interagir com as moléculas das caixas vizinhas. Além disso podemos fazer o cálculo considerando somente 1 *k-point* para x, y e z.

Em seguida, crie um gráfico com os valores da ligação no eixo $$x$$ e os valores da energia total no eixo $$y$$. Você deve obter um gráfico parecido com o mostrado abaixo:

<img src="{{ site.url }}{{ site.baseurl }}/images/posts/tutorial_qe/n2_curve.png" alt="Energia em função da distância de ligação">
Energia em função da distância de ligação, $$E(d_{N-N})$$ para a molécula de $$N_2$$. Os pontos vermelhos são os valores calculados e a linha preta um ajuste de um potencial de Morse e a linha azul o ajuste de um potencial harmônico.


[1] BOWEN, Humphrey John Moule. Tables of interatonic distances and configuration in molecules and ions. 1958.
