---
title: "Tutorial Quantum ESPRESSO: Sistemas unidimensionais (1D)"
date: 2019-08-30
tags: [QE, Tutorial]
classes: wide
header:
  teaser: images/posts/tutorial_qe/logo_header.jpg
excerpt: "Obtendo a estrutura de equilíbrio, energia coesiva e modos vibracionais para sistemas uniimensionais (1D)"
mathjax: "true"
---


Vimos até agora como procurar por mínimos na superfície de potencial de maneira manual. Essa é uma maneira extremamente robusta de busca por estruturas estáveis, além de permitir a obtenção de uma grande quantidade de informações com um tratamento simples dos dados obtidos. Os casos que vimos até agora foram relativamente simples, uma vez que pudemos construir a superfície de potencial variando apenas um parâmetro, *i.e.* comprimento de ligação ou dimensão da célula unitária.

Pense agora em um sistema levemente mais complexo, como o grafite por exemplo, que apresenta dois parâmetros da célula unitária. A superfície de energia potencial agora será não mais uma função de uma variável apenas, mas sim uma função 2 variáveis, os parâmetros $a$ e $c$ da célula unitária. Sistemas ainda mais complexos onde não só os parâmetros da célula unitária podem variar, mas também os comprimentos de ligação entre os átomos irão gerar uma hipersuperfície de energia potencial com $n$ dimensões, onde $n$ é o número de graus de liberdade do sistema. Nesses casos não é nada trivial buscar mínimos nesse tipo de função.

Para nossa sorte, existem diversos algoritmos automatizados para buscar mínimos em hipersuperfícies de energia potencial. Vamos utilizar o algorítmo **BFGS quasi-newton**. Ele é um algoritmo simples e poderoso, que em breve pretendo explorar com mais detalhes em um post exclusivo.

# Carbina

<img src="{{ site.url }}{{ site.baseurl }}/images/posts/tutorial_qe/carbina.jpg" alt="Carbina">

**Figura 1:** Diferentes estruturas da carbina.

A carbina é um alótropo de carbono formado por átomos de carbono sp ligados em uma única dimensão. Existe uma acalorada discussão na literatura se essa estrutura já foi obtida experimentalmente ou não. Além disso, podemos escrever duas estruturas diferentes para a carbina, a forma poliínica (-C≡C-)<sub>n</sub> e a forma cumulênica (=C=C=)<sub>n</sub>. Com a recente observação experimental do **cyclo[18]carbon** [1], um alótropo de carbono formado por um "anel" de carbina com 18 átomos, mais do que nunca os cálculos teóricos podem fornecer informações relevantes sobre esse tipo de sistema.

## Carbina cumulênica













Em seguida, faça um cálculo SCF para o diamante com o valor de $$a$$ de equilíbrio obtido anteriormente, modifique o script utilizado para calcular a dispersão de fônons do grafeno e o utilize para calcular a dispersão de fônons no diamante. Calcule em um grid de **q-vetores** de 4x4x4, seguindo o caminho $$\Gamma$$-X-K-$$\Gamma$$-L-X-W-L no espaço recíproco:

```bash
&inputph
  prefix='$PREFIX',
  recover=.true.,
  outdir='.'
  ldisp=.true. ,
	fildyn='$PREFIX.dyn' ,
  nq1=4 , nq2=4 , nq3=4 ,
  tr2_ph=1.0d-16,
/
```

Em seguida faça o pós-processamento dos dados.

```bash
Q2R_COMMAND="mpirun /home/users/lipelopes/qe-6.4/bin/q2r.x"
MATDYN_COMMAND="mpirun -np 8 /home/users/lipelopes/qe-6.4/bin/matdyn.x"
CMD_PLOT="mpirun /home/users/lipelopes/qe-6.4/bin/plotband.x"

# run q2r to calculate the interatomic force constants -
IFCs (in realspace) from the dynamical matrices (in q space)
cat > $PREFIX.q2r.in <<EOF
 &input
	fildyn='$PREFIX.dyn',	flfrc='$PREFIX.fc',	zasr='crystal',
/
EOF

$Q2R_COMMAND < $PREFIX.q2r.in > $PREFIX.q2r.out

#  recalculate omega(q) from C(R) using matdyin through k-path
cat > $PREFIX.matdyn_disp.in <<EOF
 &input
	q_in_band_form=.true., flfrc='$PREFIX.fc',
  flfrq='$PREFIX.freq', asr='crystal',
/
10
    0.00000000     0.00000000     0.00000000   120 !gG
    0.00000000     1.00000000     0.00000000    0  !X
    1.00000000     1.00000000     0.00000000   120 !X
    0.75000000     0.75000000     0.00000000   120 !K
    0.00000000     0.00000000     0.00000000   120 !gG
    0.50000000     0.50000000     0.50000000   120 !L
    0.00000000     1.00000000     0.00000000    0  !X
    1.00000000     1.00000000     0.00000000   120 !X
    0.50000000     1.00000000    -0.00000000   120 !W
    0.50000000     0.50000000     0.50000000   120 !L
EOF

$MATDYN_COMMAND < $PREFIX.matdyn_disp.in > $PREFIX.matdyn_disp.out

# Plotband
cat > $PREFIX.plotband.in <<EOF
$PREFIX.freq
-150 2000
freq.plot
freq.ps
0.0
200.0
0.0
EOF

$CMD_PLOT < $PREFIX.plotband.in > $PREFIX.plotband.out
```

Abaixo, você pode observar o resultado do cálculo, comparado com valores experimentais obtidos de [3] e [4].

<img src="{{ site.url }}{{ site.baseurl }}/images/posts/tutorial_qe/diamante_phdisp.png" alt="Dispersão de fônons para o diamante">

**Figura 2:** Gráfico da dispersão de fônons pelo k-path: $$\Gamma-X-K-\Gamma-L-X-W-L$$ à esquerda e densidade de estados de vibracionais à direita. Os pontos vermelhos são os dados experimentais para o diamante retirados de [3] e [4].


Os dados experimentais estão disponíveis [aqui]({{ site.url }}{{ site.baseurl }}/dados/exp_diamante.csv).


[1] [KAISER, Katharina et al. *An sp-hybridized molecular carbon allotrope, cyclo [18] carbon*. **Science**, v. 365, n. 6459, p. 1299-1301, 2019.](https://science.sciencemag.org/content/365/6459/1299.abstract) [PDF](https://arxiv.org/ftp/arxiv/papers/1908/1908.05904.pdf)

[2] [MACDONALD, J. Ross. *Review of some experimental and analytical equations of state*. **Reviews of Modern Physics**, v. 41, n. 2, p. 316, 1969.](https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.41.316)

[2] [WARREN, J. L. et al. *Lattice dynamics of diamond*. **Physical Review**, v. 158, n. 3, p. 805, 1967.](https://journals.aps.org/pr/abstract/10.1103/PhysRev.158.805)

[3] [PAVONE, P. et al. *Ab initio lattice dynamics of diamond*. **Physical Review B**, v. 48, n. 5, p. 3156, 1993.](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.48.3156)[PDF](https://s3.amazonaws.com/academia.edu.documents/42482248/Ab_initio_lattice_dynamics_of_diamond20160209-26373-js7mcd.pdf?response-content-disposition=inline%3B%20filename%3DAb_initio_lattice_dynamics_of_diamond.pdf&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWOWYYGZ2Y53UL3A%2F20190928%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20190928T164421Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=02b0d06f2d501209e10482e630841f3d4308f98e9ccdebf3843c371015ebcaf9)
