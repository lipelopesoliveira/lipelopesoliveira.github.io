---
title: "Tutorial Quantum ESPRESSO: Sistemas unidimensionais (1D)"
date: 2019-08-30
tags: [QE, Tutorial]
classes: wide
header:
  teaser: images/posts/tutorial_qe/logo_header.jpg
excerpt: "Obtendo a estrutura de equilíbrio, energia coesiva e modos vibracionais para sistemas uniimensionais (1D)"
mathjax: "true"
---


Vimos até agora como procurar por mínimos na superfície de potencial de maneira manual. Essa é uma maneira extremamente robusta de busca por estruturas estáveis, além de permitir a obtenção de uma grande quantidade de informações com um tratamento simples dos dados obtidos. Os casos que vimos até agora foram relativamente simples, uma vez que pudemos construir a superfície de potencial variando apenas um parâmetro, *i.e.* comprimento de ligação ou dimensão da célula unitária.

Pense agora em um sistema levemente mais complexo, como o grafite por exemplo, que apresenta dois parâmetros da célula unitária. A superfície de energia potencial agora será não mais uma função de uma variável apenas, mas sim uma função 2 variáveis, os parâmetros $$a$$ e $$c$$ da célula unitária. Sistemas ainda mais complexos onde não só os parâmetros da célula unitária podem variar, mas também os comprimentos de ligação entre os átomos irão gerar uma hipersuperfície de energia potencial com $$n$$ dimensões, onde $$n$$ é o número de graus de liberdade do sistema. Nesses casos não é nada trivial buscar mínimos nesse tipo de função.

Para nossa sorte, existem diversos algoritmos automatizados para buscar mínimos em hipersuperfícies de energia potencial. Vamos utilizar o algorítmo **BFGS quasi-newton**. Ele é um algoritmo simples e poderoso, que em breve pretendo explorar com mais detalhes em um post exclusivo.

# Carbina

<img src="{{ site.url }}{{ site.baseurl }}/images/posts/tutorial_qe/carbina.jpg" alt="Carbina">

**Figura 1:** Diferentes estruturas da carbina.

A carbina é um alótropo de carbono formado por átomos de carbono sp ligados em uma única dimensão. Existe uma acalorada discussão na literatura se essa estrutura já foi obtida experimentalmente ou não. Além disso, podemos escrever duas estruturas diferentes para a carbina, a forma poliínica (-C≡C-)<sub>n</sub> e a forma cumulênica (=C=C=)<sub>n</sub>. Com a recente observação experimental do **cyclo[18]carbon** [1], um alótropo de carbono formado por um "anel" de carbina com 18 átomos, mais do que nunca os cálculos teóricos podem fornecer informações relevantes sobre esse tipo de sistema.

## Carbina cumulênica

Vamos começar obtendo a estrutura da carbina cumulênica. Vamos montar uma célula unitária tetragonal, com $$x$$ e $$y$$ com um *slab* bem grande, para evitarmos interação entre as cadeias, e os átomos no eixo $$z$$. Como estamos considerando os comprimentos de ligação iguais, vamos colocar os átomos nas posições (0.5, 0.5, 0.25) e (0.5, 0.5, 0.75). A princípio os átomos poderiam ser colocados em qualquer posição da célula unitária, mas dessa forma nos aproveitamos da simetria do sistema para acelerar o cálculo. Segue a abaixo o *input* para o cálculo. Como o sistema é pequeno e com poucos átomos, vamos apertar bastante os parâmetros para não termos problemas de convergência.  

```
&control
   calculation = 'vc-relax' ,
   restart_mode = 'from_scratch' ,
   wf_collect = .false. ,
   outdir = '.' ,
   pseudo_dir = '/home/pseudo' ,
   prefix = '$PREFIX' ,
   nstep=1000 ,
   etot_conv_thr = 1.0d-4 ,
   forc_conv_thr = 1.0d-5 ,
   verbosity ='high' ,
   tstress = .true. ,
   tprnfor = .true. ,
/
&system
   ibrav=  6,
   celldm(1) =     15
   celldm(3) =      0.322847788
   nat =  2 ,
   ntyp = 1 ,
   ecutwfc = 120.0 ,
   ecutrho = 1000.0 ,
/
&electrons
   conv_thr =  1.0D-10 ,
   electron_maxstep = 5000 ,
/
&IONS
   ion_dynamics = 'bfgs'
/
&CELL
   cell_dynamics = 'bfgs'
   cell_dofree = 'z'
/
ATOMIC_SPECIES
   C   12.0107  C.pbe-n-rrkjus_psl.0.1.UPF

ATOMIC_POSITIONS (crystal)
C       0.50000000     0.50000000     0.25000000
C       0.50000000     0.50000000     0.75000000
K_POINTS automatic
  1 1 36   0 0 0
```

Perceba que fizemos um cálculo do tipo `vc-relax`, onde tanto os parâmetros de célula quanto os átomos podem relaxar suas posições. Nesse caso, como é um sistema 1D, permitimos somente que a célula unitária relaxe no eixo $$z$$. Ambos átomos e parâmetros de célula devem sempre apresentar a mesma dinâmica de movimentos, que é definida pelo algoritmo de busca de mínimos na superfície de energia potencial. Obtemos então o resultado abaixo:

```
!    total energy              =     -23.76675019 Ry

...

CELL_PARAMETERS (alat= 15.00000000)
   1.000000000   0.000000000   0.000000000
   0.000000000   1.000000000   0.000000000
   0.000000000   0.000000000   0.322608697

ATOMIC_POSITIONS (crystal)
C        0.500000000   0.500000000   0.250000216
C        0.500000000   0.500000000   0.749999784
```


Veja que os átomos apresentaram um pequeno deslocamento no eixo $$x$$, que é absolutamente irrelevante. O parâmetro $$z$$ obtido foi 4.8391 bohr = 2.5601 Å. Ou seja, obtemos um comprimento das ligações cumulênicas de 1.2804 Å.

Precisamos agora calcular os modos normais de vibração, para ter certeza que essa estrutura corresponde à um mínimo local ou é um ponto de cela. Basta executar um cálculo SCF com a estrutura em equilíbrio obtida e, em seguida, executar os scripts abaixo. O primeiro realiza o cálculo dos fônons usando a *Density-Functional Perturbation Theory* e o segundo aplica a regra da soma acústica na matriz dinâmica para um sistema 1D.

```bash

PREFIX="carbina"
PSEUDO_DIR="/home/interlab/felipe/Pseudo"

CMD_PH="mpirun -np 8 /home/interlab/qe-6.4.1/bin/ph.x -nk 2"
CMD_DYNMAT="/home/interlab/qe-6.4.1/bin/dynmat.x"

cat>$PREFIX.phG.in<<EOF
phonons on a grid
&inputph
	prefix='$PREFIX',
	recover=.true.
	fildyn='$PREFIX.dyn.G',
	tr2_ph=1.0d-14,
	asr=.true.,
/
0.0 0.0 0.0
/
EOF
$CMD_PH < $PREFIX.phG.in > $PREFIX.phG.out

#Make DynMat Acoustic Sum Rules calculation
cat>$PREFIX.asr.in<<EOF
$PREFIX - Acoustic Sum Rules - DynMat
&input
	fildyn ='$PREFIX.dyn.G' ,
	asr='one-dim' ,
/
EOF
$CMD_DYNMAT < $PREFIX.asr.in > $PREFIX.asr.out
```

Como resultando você deve obter o arquivo `carbina.asr.out` com os dados:

```
IR activities are in (D/A)^2/amu units

# mode   [cm-1]    [THz]      IR
1     -0.00   -0.0000    0.0000
2      0.00    0.0000    0.0000
3      0.00    0.0000    0.0000
4    487.50   14.6148    0.0000
5    487.50   14.6148    0.0000
6   1502.36   45.0398    0.0000
```

Nele vemos as frequências dos modos vibracionais e a intensidade de absorção de IR. Como todos os modos são simétricos, nenhum deles apresenta atividades de IR. Podemos utilizar o X-CrysDen para visualizar os vetores de deslocamento referentes a cada vibração. Basta abrir o arquivo `dynmat.axsf` e ir em `Vizualization > Display Forces`.

Abaixo é possível conferir a representação visual de cada modo vibracional.


Os dados experimentais estão disponíveis [aqui]({{ site.url }}{{ site.baseurl }}/dados/exp_diamante.csv).


[1] [KAISER, Katharina et al. *An sp-hybridized molecular carbon allotrope, cyclo [18] carbon*. **Science**, v. 365, n. 6459, p. 1299-1301, 2019.](https://science.sciencemag.org/content/365/6459/1299.abstract) [PDF](https://arxiv.org/ftp/arxiv/papers/1908/1908.05904.pdf)

[2] [MACDONALD, J. Ross. *Review of some experimental and analytical equations of state*. **Reviews of Modern Physics**, v. 41, n. 2, p. 316, 1969.](https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.41.316)

[2] [WARREN, J. L. et al. *Lattice dynamics of diamond*. **Physical Review**, v. 158, n. 3, p. 805, 1967.](https://journals.aps.org/pr/abstract/10.1103/PhysRev.158.805)

[3] [PAVONE, P. et al. *Ab initio lattice dynamics of diamond*. **Physical Review B**, v. 48, n. 5, p. 3156, 1993.](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.48.3156)[PDF](https://s3.amazonaws.com/academia.edu.documents/42482248/Ab_initio_lattice_dynamics_of_diamond20160209-26373-js7mcd.pdf?response-content-disposition=inline%3B%20filename%3DAb_initio_lattice_dynamics_of_diamond.pdf&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWOWYYGZ2Y53UL3A%2F20190928%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20190928T164421Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=02b0d06f2d501209e10482e630841f3d4308f98e9ccdebf3843c371015ebcaf9)
